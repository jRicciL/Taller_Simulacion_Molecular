---
title: 'Tarea: Cribado Virtual con Smina'
---
***

# Tarea 2: Cribado Virtual con Smina

## Objetivo

- Realizar **<mark>4 ensayos de cribado virtual (CV)</mark>**  utilizando Smina.
- La librer√≠a de mol√©culas consiste en 50 compuestos del *benchmarking set* [CSAR 2012](http://www.csardock.org/), el cual incluye compuestos **activos** (*true binders - inhibitors*) e **inactivos** de la prote√≠na CDK2 (experimentalmente probados). M√°s sobre este *challenge* CSAR 2012 [aqu√≠](https://pubs.acs.org/doi/10.1021/ci4000486).
- Se usar√°n dos conformaciones de la prote√≠na CDK2.
    - [2vv9](https://www.rcsb.org/structure/2VV9)
    - [5a14](https://www.rcsb.org/structure/5A14)
  
> **Nota**: No descargar los `pdb` de las prote√≠nas de estos links. M√°s abajo se brindan los links de descarga de los archivos a usar.

- Se usar√°n dos funciones de *scoring* (a una exhaustividad de **12**):
  - [vina](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3041641/)
  - [vinardo](https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0155183)
- Cada ensayo de CV **combina** una conformaci√≥n de la prote√≠na y una funci√≥n de *scoring*. D√°ndo como resultado **4 ensayos de CV**.
- Reportar los **resultados** y **comparar** el desempe√±o del CV en funci√≥n del *scoring* utilizado y las conformaciones de la prote√≠na.

## Instrucciones

1. **Descarga** el archivo de las prote√≠nas y de las mol√©culas en formato SMILES ‚¨áÔ∏è:
   - Prote√≠nas : 
     - [2vv9_PROT.pdb](https://raw.githubusercontent.com/jRicciL/Taller_Simulacion_Molecular/master/resurces/vs/2vv9_PROT.pdb)
     - [5a14_PROT.pdb](https://raw.githubusercontent.com/jRicciL/Taller_Simulacion_Molecular/master/resurces/vs/5a14_PROT.pdb)
   - Archivo de ligandos (SMILES): [cdk2_mols.smi](https://raw.githubusercontent.com/jRicciL/Taller_Simulacion_Molecular/master/resurces/vs/cdk2_mols.smi)

2. **Descarga** los siguientes archivos y **guardalos** en tu directorio de trabajo ‚¨áÔ∏è (ser√°n necesarios para el an√°lisis final):
   - [cdk2_activity_mols.csv](https://raw.githubusercontent.com/jRicciL/Taller_Simulacion_Molecular/master/resurces/vs/cdk2_activity_mols.csv)
   - [plot_metrics.py](https://raw.githubusercontent.com/jRicciL/Taller_Simulacion_Molecular/master/resurces/vs/plot_metrics.py)
   - [analisis_resultados_vina.ipynb](https://raw.githubusercontent.com/jRicciL/Taller_Simulacion_Molecular/master/resurces/vs/analisis_resultados_vina.ipynb)

3. **Apoyate del siguiente material** para realizar los ensayos de CV: [Acoplamiento molecular con Smina](https://jriccil.github.io/Taller_Simulacion_Molecular/virtual_screening_vina.html)

4. **Especificaciones** de las corridas de *docking*:
   1. Usar un valor de exhaustividad de `12`.
   2. El sitio activo es el mismo que en la tarea anterior (para ambas conformaciones). Un caja que cubra los residuos *9, 33, 86, 88, 89, 132, 145* y *146* debe ser m√°s que suficiente.
   3. Usa el par√°metro `--scoring vina` o `--scoring vinardo` para definir la funci√≥n de *scoring* correspondiente a cada ensayo. Revisa el `help` de smina si tienes dudas (`smina --help`).
   4. Usa el notebook de jupyter `analisis_resultados_vina.ipynb` para generar las gr√°ficas de resultados de cada ensayo.


## Reporte

**En reporte de resultados consiste en lo siguiente:**

1. **Mostrar las 3 gr√°ficas de resultados, debidamente tituladas y etiquetadas, de cada ensayo de CV en una diapositiva de `ppt`:**
   - Gr√°fico del ranking de mol√©culas activas vs activas.
   - Curva ROC, incluyendo el valor del AUC-ROC.
   - Histogramas del scoring de activos vs inactivos.

2. **En la diapositiva correspondiente, reporta las 3 mejores mol√©culas (con menor energ√≠a libre de interacci√≥n con la prote√≠na) de cada ensayo de CV.**
   - Escribe el nombre, el valor de energ√≠a predicho y si la mol√©cula es realmente activa o no.

<!-- 3. **En la diapositiva correspondiente, incluye una imagen del acoplamiento con la mejor mol√©cula seg√∫n cada ensayo de CV.**
   - Puedes usar UCSF Chimera o Autodock Tools.
   - Muestra la mejor pose de la mejor mol√©cula de cada ensayo, incluye en la visualizaci√≥n los residuos *9, 33, 86, 88, 89, 132, 145* y *146*.
   - Puedes visitar el siguiente link para ver c√≥mo generar algunas visualizaciones de inter√©s: https://www.cgl.ucsf.edu/chimera/docs/UsersGuide/frametut.html -->

3. **En una √∫ltima diapositiva, responder las siguientes preguntas:**
   1. ¬øConsideras que la funci√≥n de *scoring* elegida marca alguna diferencia en los resultados del CV? ¬øPor qu√©?
   2. ¬øConsideras que la conformaci√≥n elegida marca alguna diferencia en los resultados del CV? ¬øPor qu√©?
   3. ¬øHay alguna diferencia destacable entre los sitios de uni√≥n de ambas conformaciones? ¬øCu√°l?
   4. Si tuvieras que hacer un cribado virtual para descubrir nuevos inhibidores de la CDK2 a partir de una librer√≠a de 1,000,000 de mol√©culas, ¬øQu√© conformaci√≥n y qu√© funci√≥n de scoring usar√≠as?
   5. ¬øQu√© mol√©culas activas representan un mayor desaf√≠o para el programa de *docking*? ¬øTendr√° algo que ver el tama√±o de la mol√©cula?
   6. En los cuatro ensayos de VS ¬øhay mol√©culas que tiendan a tener siempre los valores m√°s bajos de energ√≠a de interacci√≥n (*scoring*)? ¬øA qu√© crees que se deba independientemente de que sean activas o inactivas?

5. **Anota tu nombre en la √∫ltima diapositiva.**

6. üö® üö® üö® **Enviar √∫nicamente el archivo pdf por mensaje personal a mi cuenta (Joel Ricci) en el Slack del grupo.**
7. <mark>Fecha l√≠mite de env√≠o es el d√≠a viernes 26 de febrero a las 24:00 horas.</mark>

## Algunos *tips*:
1. üö® **¬°No te conf√≠es con el tiempo!** üö®
   1. La duraci√≥n de cada ensayo de CV puede tomar desde 30 min a 2 horas ‚è± (en promedio 1-1:30 min por mol√©cula) dependiendo de los recursos de tu equipo y de el n√∫mero de procesadores que utilices (revisa el par√°metro `cpu` de smina).
   2. Usa como m√≠nimo dos procesadores (`cpu`), si tu equipo cuenta con m√°s, puedes aprovecharlo üíª.
   3. Planifica bien en qu√© momento realizar√°s las corridas de *docking* tomando en cuenta lo anterior üìù. 
2. De preferencia **realiza cada ensayo de CV en una carpeta independiente** para evitar confundirte y sobreescribir archivos de ensayos previos üò∞.
3. Recuerda que el tama√±o del grid est√° en √Ö. Un grid demasiado grande har√° mucho m√°s tardado el an√°lisis. Una caja no mayor a `24x24x24` (incluso un poco menos) deber√≠a bastar para ambas conformaciones.
   1. En *Chimera* puedes utilizar el *Command Line* para seleccionar los residuos mencionados arriba y usarlos de referencia para trazar la caja -> `sel :9,33,86,88,89,132,145,146`
4. Basta con hacer la fase de preparaci√≥n de los `pdbqt` una sola vez. 
5. Si te sirve, **anota los comandos y ciclos for que vas utilizando** en un archivo de texto (sustituyendo adecuadamente los nombres de los archivos de entrada y salida).

## Recursos

- [Curso de bash scripting en Datacamp](https://www.datacamp.com/courses/introduction-to-bash-scripting). **¬°Tienes acceso gratis!**
- [P√°gina de descarga de smina con algunos recursos extra](https://sourceforge.net/projects/smina/files/)